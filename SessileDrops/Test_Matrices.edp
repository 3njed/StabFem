

// petit programme Freefem pour resoudre F'' = -1 avec cl. F(0)=F(1)=0 (diff. finies)
// la solution exacte est F = y*(1-y)/2


real L = 1;
int Ndim = 101;
real ddx = 1.*L/(Ndim-1);
real[int] X(Ndim);

// construction du maillage
for(int i =0;i<Ndim;i++)
	{	
	X(i) = 1.*i/(Ndim-1);
	};


real[int,int] a(Ndim,Ndim);
real[int] RHS(Ndim);
real[int] F(Ndim);

for(int i =1;i<Ndim-1;i++)
	{
		a(i,i)=-2/ddx^2;
		a(i,i-1)=1/ddx^2;
		a(i,i+1)=1/ddx^2; 
	//cout << "rangee " << i << " : " << a(i,i-1) << " " << a(i,i) << " " << a(i,i+1) << endl;
	};
	a(0,0) = 1;
	a(Ndim-1,Ndim-1)=1;

for(int i =1;i<Ndim-1;i++)
	{	
	RHS(i) = -1;
	};
	RHS(0)=0;
	RHS(Ndim-1)=0;
	
matrix A = a;
set(A,solver=sparsesolver);
F = A^-1*RHS;

ofstream File("Test.txt");

for(int i =0;i<Ndim;i++)
	{	
	File << X(i) << " " << F(i) << endl;
	};




