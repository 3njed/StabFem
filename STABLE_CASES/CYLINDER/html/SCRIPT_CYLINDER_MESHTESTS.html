
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>SCRIPT_CYLINDER_MESHTESTS</title><meta name="generator" content="MATLAB 9.3"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2018-11-29"><meta name="DC.source" content="SCRIPT_CYLINDER_MESHTESTS.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><pre class="codeinput"><span class="comment">%  Instability of the wake of a cylinder with STABFEM</span>
<span class="comment">%</span>
<span class="comment">%  THIS SCRIPT COMPARES THE RESULTS OBTAINED WITH 7 DIFFERENT MESHES</span>

<span class="comment">% CHAPTER 0 : set the global variables needed by the drivers</span>

run(<span class="string">'../../SOURCES_MATLAB/SF_Start.m'</span>);
verbosity=0;
figureformat=<span class="string">'png'</span>; AspectRatio = 0.56; <span class="comment">% for figure</span>
</pre><pre class="codeinput"> <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
 disp(<span class="string">' '</span>);
 disp(<span class="string">'### 1 : MESH based on base flow : '</span>);
 disp(<span class="string">' '</span>);
 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>


 bf=SF_Init(<span class="string">'Mesh_Cylinder.edp'</span>,[-40 80 40]);
 bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,1);
 bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,10);
 bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
 bf=SF_Adapt(bf,<span class="string">'Hmax'</span>,10);
 bf=SF_Adapt(bf,<span class="string">'Hmax'</span>,10);

disp(<span class="string">' '</span>);
disp([<span class="string">'number of vertices : '</span> num2str(bf.mesh.np)]);
disp([<span class="string">'number of DOF : '</span> num2str(bf.mesh.Ndof)]);
disp(<span class="string">'### Mesh grid size at point A,B,C,D : '</span>);
disp([<span class="string">'A   : '</span> num2str(bf.mesh.deltaA)]);
disp([<span class="string">'B   : '</span> num2str(bf.mesh.deltaB)]);
disp([<span class="string">'C   : '</span> num2str(bf.mesh.deltaC)]);
disp([<span class="string">'D   : '</span> num2str(bf.mesh.deltaD)]);
disp([<span class="string">'min : '</span> num2str(bf.mesh.deltamin)]);
disp([<span class="string">'max : '</span> num2str(bf.mesh.deltamax)]);
disp(<span class="string">' '</span> );

bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.74i,<span class="string">'type'</span>,<span class="string">'D'</span>);
disp(<span class="string">'##### EIGENVALUE COMPUTATION'</span>);

disp([<span class="string">' Eigenvalue : '</span> , num2str(ev)]);

[meanflow,mode] = SF_HB1(bf,em,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.04,<span class="string">'Fyguess'</span>,0.015);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.03);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.02);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.0,<span class="string">'specialmode'</span>,<span class="string">'NEW'</span>);

disp(<span class="string">'##### NONLINEAR SELFCONSISTENT COMPUTATION'</span>);
disp([<span class="string">'mean Fx : '</span> num2str(meanflow.Fx)]);
disp([<span class="string">'mean Lx : '</span> num2str(meanflow.Lx)]);
disp([<span class="string">'Mode Fy : '</span> num2str(mode.Fy)]);
disp([<span class="string">'Mode AE : '</span> num2str(mode.AEnergy)]);
disp([<span class="string">'Mode omega : '</span> num2str(imag(mode.lambda))]);
</pre><pre class="codeoutput"> 
### 1 : MESH based on base flow : 
 

ans =

     0

rm: ./WORK//MEANFLOWS/*: No such file or directory
rm: ./WORK/Eigenmode*: No such file or directory
rm: ./WORK//BASEFLOWS/*: No such file or directory
rm: ./WORK//MEANFLOWS/*: No such file or directory
rm: ./WORK/Eigenmode*: No such file or directory
 
number of vertices : 1362
number of DOF : 11952
### Mesh grid size at point A,B,C,D : 
A   : 0.023395
B   : 0.59277
C   : 0.62453
D   : 1.2523
min : 0.015715
max : 14.1421
 
      # Stability calculation completed, eigenvalue = 0.047225+0.74241i ; converged in 7 iterations
##### EIGENVALUE COMPUTATION
 Eigenvalue : 0.047225+0.74241i
##### NONLINEAR SELFCONSISTENT COMPUTATION
mean Fx : 0.69414
mean Lx : 2.5909
Mode Fy : 0.065758-9.541e-18i
Mode AE : 1.8158
Mode omega : 0.84406
</pre><pre class="codeinput"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
disp(<span class="string">' '</span> );
disp(<span class="string">'### 2 : ADAPT ON SENSITIVITY (ref case)'</span>);
disp(<span class="string">' '</span> );
<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.745i,<span class="string">'type'</span>,<span class="string">'S'</span>);
bf=SF_Adapt(bf,em,<span class="string">'Hmax'</span>,10);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.745i,<span class="string">'type'</span>,<span class="string">'S'</span>);
bf=SF_Adapt(bf,em,<span class="string">'Hmax'</span>,10);


<span class="comment">% plot the mesh (full size)</span>
bf.xlim = [-40 80]; bf.ylim=[0,40];
SF_Plot(bf,<span class="string">'mesh'</span>);
<span class="comment">%title('Mesh M2 (full size)');</span>
box <span class="string">on</span>; pos = get(gcf,<span class="string">'Position'</span>); pos(4)=pos(3)*.4;set(gcf,<span class="string">'Position'</span>,pos); <span class="comment">% resize aspect ratio</span>
set(gca,<span class="string">'FontSize'</span>, 18);
saveas(gca,<span class="string">'FIGURES/Cylinder_Mesh2_Full'</span>,figureformat);

<span class="comment">% plot the mesh (zoom)</span>
SF_Plot(bf,<span class="string">'mesh'</span>,<span class="string">'xlim'</span>,[-1.5 4.5],<span class="string">'ylim'</span>,[0,3]);
<span class="comment">%title('Mesh M2 (zoom)');</span>
box <span class="string">on</span>; pos = get(gcf,<span class="string">'Position'</span>); pos(4)=pos(3)*AspectRatio;set(gcf,<span class="string">'Position'</span>,pos); <span class="comment">% resize aspect ratio</span>
set(gca,<span class="string">'FontSize'</span>, 18);
saveas(gca,<span class="string">'FIGURES/Cylinder_Mesh2'</span>,figureformat);
pause(0.1);

disp(<span class="string">' '</span>);
disp([<span class="string">'number of vertices : '</span> num2str(bf.mesh.np)]);
disp([<span class="string">'number of DOF : '</span> num2str(bf.mesh.Ndof)]);
disp(<span class="string">'### Mesh grid size at point A,B,C,D : '</span>);
disp([<span class="string">'A   : '</span> num2str(bf.mesh.deltaA)]);
disp([<span class="string">'B   : '</span> num2str(bf.mesh.deltaB)]);
disp([<span class="string">'C   : '</span> num2str(bf.mesh.deltaC)]);
disp([<span class="string">'D   : '</span> num2str(bf.mesh.deltaD)]);
disp([<span class="string">'min : '</span> num2str(bf.mesh.deltamin)]);
disp([<span class="string">'max : '</span> num2str(bf.mesh.deltamax)]);
disp(<span class="string">' '</span> );

bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.74i,<span class="string">'type'</span>,<span class="string">'D'</span>);
disp(<span class="string">'##### EIGENVALUE COMPUTATION'</span>);

disp([<span class="string">' Eigenvalue : '</span> , num2str(ev)]);

[meanflow,mode] = SF_HB1(bf,em,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.04,<span class="string">'Fyguess'</span>,0.015);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.03);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.02);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.0,<span class="string">'specialmode'</span>,<span class="string">'NEW'</span>);

disp(<span class="string">'##### NONLINEAR SELFCONSISTENT COMPUTATION'</span>);
disp([<span class="string">'mean Fx : '</span> num2str(meanflow.Fx)]);
disp([<span class="string">'mean Lx : '</span> num2str(meanflow.Lx)]);
disp([<span class="string">'Mode Fy : '</span> num2str(mode.Fy)]);
disp([<span class="string">'Mode AE : '</span> num2str(mode.AEnergy)]);
disp([<span class="string">'Mode omega : '</span> num2str(imag(mode.lambda))]);
</pre><pre class="codeoutput"> 
### 2 : ADAPT ON SENSITIVITY (ref case)
 
rm: ./WORK//BASEFLOWS/*: No such file or directory
rm: ./WORK//MEANFLOWS/*: No such file or directory
 
number of vertices : 1983
number of DOF : 17487
### Mesh grid size at point A,B,C,D : 
A   : 0.023546
B   : 0.17477
C   : 0.25366
D   : 1.3396
min : 0.015206
max : 14.8645
 
      # Stability calculation completed, eigenvalue = 0.046901+0.74498i ; converged in 7 iterations
##### EIGENVALUE COMPUTATION
 Eigenvalue : 0.046901+0.74498i
##### NONLINEAR SELFCONSISTENT COMPUTATION
mean Fx : 0.69343
mean Lx : 2.6176
Mode Fy : 0.06391+4.3368e-18i
Mode AE : 1.7351
Mode omega : 0.8442
</pre><img vspace="5" hspace="5" src="SCRIPT_CYLINDER_MESHTESTS_01.png" alt=""> <pre class="codeinput"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
disp(<span class="string">' '</span> );
disp(<span class="string">'### 2bis : ADAPT ON SENSITIVITY (split)'</span>);
disp(<span class="string">' '</span> );
<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

bf=SF_Split(bf);

disp(<span class="string">' '</span>);
disp([<span class="string">'number of vertices : '</span> num2str(bf.mesh.np)]);
disp([<span class="string">'number of DOF : '</span> num2str(bf.mesh.Ndof)]);
disp(<span class="string">'### Mesh grid size at point A,B,C,D : '</span>);
disp([<span class="string">'A   : '</span> num2str(bf.mesh.deltaA)]);
disp([<span class="string">'B   : '</span> num2str(bf.mesh.deltaB)]);
disp([<span class="string">'C   : '</span> num2str(bf.mesh.deltaC)]);
disp([<span class="string">'D   : '</span> num2str(bf.mesh.deltaD)]);
disp([<span class="string">'min : '</span> num2str(bf.mesh.deltamin)]);
disp([<span class="string">'max : '</span> num2str(bf.mesh.deltamax)]);
disp(<span class="string">' '</span> );

bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.74i,<span class="string">'type'</span>,<span class="string">'D'</span>);

disp(<span class="string">'##### EIGENVALUE COMPUTATION'</span>);

disp([<span class="string">' Eigenvalue : '</span> , num2str(ev)]);

[meanflow,mode] = SF_HB1(bf,em,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.04,<span class="string">'Fyguess'</span>,0.015);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.03);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.02);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.0,<span class="string">'specialmode'</span>,<span class="string">'NEW'</span>);

disp(<span class="string">'##### NONLINEAR SELFCONSISTENT COMPUTATION'</span>);
disp([<span class="string">'mean Fx : '</span> num2str(meanflow.Fx)]);
disp([<span class="string">'mean Lx : '</span> num2str(meanflow.Lx)]);
disp([<span class="string">'Mode Fy : '</span> num2str(mode.Fy)]);
disp([<span class="string">'Mode AE : '</span> num2str(mode.AEnergy)]);
disp([<span class="string">'Mode omega : '</span> num2str(imag(mode.lambda))]);
</pre><pre class="codeoutput"> 
### 2bis : ADAPT ON SENSITIVITY (split)
 
 
number of vertices : 7752
number of DOF : 69054
### Mesh grid size at point A,B,C,D : 
A   : 0.011535
B   : 0.086552
C   : 0.11218
D   : 0.67223
min : 0.0076033
max : 7.4323
 
      # Stability calculation completed, eigenvalue = 0.046868+0.74513i ; converged in 9 iterations
##### EIGENVALUE COMPUTATION
 Eigenvalue : 0.046868+0.74513i
##### NONLINEAR SELFCONSISTENT COMPUTATION
mean Fx : 0.6937
mean Lx : 2.6138
Mode Fy : 0.064013+8.6736e-19i
Mode AE : 2.0422
Mode omega : 0.84394
</pre><pre class="codeinput"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
disp(<span class="string">' '</span> );
disp(<span class="string">'### 3 : ADAPT ON ENDOGENEITY'</span>);
disp(<span class="string">' '</span> );
<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.745i,<span class="string">'type'</span>,<span class="string">'E'</span>);
bf=SF_Adapt(bf,em,<span class="string">'Hmax'</span>,10);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.745i,<span class="string">'type'</span>,<span class="string">'E'</span>);
bf=SF_Adapt(bf,em,<span class="string">'Hmax'</span>,10);

disp(<span class="string">' '</span>);
disp([<span class="string">'number of vertices : '</span> num2str(bf.mesh.np)]);
disp(<span class="string">'### Mesh grid size at point A,B,C,D : '</span>);
disp([<span class="string">'A   : '</span> num2str(bf.mesh.deltaA)]);
disp([<span class="string">'B   : '</span> num2str(bf.mesh.deltaB)]);
disp([<span class="string">'C   : '</span> num2str(bf.mesh.deltaC)]);
disp([<span class="string">'D   : '</span> num2str(bf.mesh.deltaD)]);
disp([<span class="string">'min : '</span> num2str(bf.mesh.deltamin)]);
disp([<span class="string">'max : '</span> num2str(bf.mesh.deltamax)]);
disp(<span class="string">' '</span> );

bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.74i,<span class="string">'type'</span>,<span class="string">'D'</span>);
disp(<span class="string">'##### EIGENVALUE COMPUTATION'</span>);

disp([<span class="string">' Eigenvalue : '</span> , num2str(ev)]);
[meanflow,mode] = SF_HB1(bf,em,<span class="string">'sigma'</span>,0.04,<span class="string">'Re'</span>,60,<span class="string">'FYguess'</span>,0.015);
<span class="comment">%[meanflow,mode] = SF_HB1(bf,em,'Re',60,'sigma',0.04,'Fyguess',0.015);</span>
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.03);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.02);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.0,<span class="string">'specialmode'</span>,<span class="string">'NEW'</span>);

disp(<span class="string">'##### NONLINEAR SELFCONSISTENT COMPUTATION'</span>);
disp([<span class="string">'mean Fx : '</span> num2str(meanflow.Fx)]);
disp([<span class="string">'mean Lx : '</span> num2str(meanflow.Lx)]);
disp([<span class="string">'Mode Fy : '</span> num2str(mode.Fy)]);
disp([<span class="string">'Mode AE : '</span> num2str(mode.AEnergy)]);
disp([<span class="string">'Mode omega : '</span> num2str(imag(mode.lambda))]);
</pre><pre class="codeoutput"> 
### 3 : ADAPT ON ENDOGENEITY
 
rm: ./WORK//BASEFLOWS/*: No such file or directory
rm: ./WORK//MEANFLOWS/*: No such file or directory
 
number of vertices : 3924
### Mesh grid size at point A,B,C,D : 
A   : 0.02022
B   : 0.13956
C   : 0.21531
D   : 0.46501
min : 0.015466
max : 13.623
 
      # Stability calculation completed, eigenvalue = 0.046746+0.74499i ; converged in 7 iterations
##### EIGENVALUE COMPUTATION
 Eigenvalue : 0.046746+0.74499i
##### NONLINEAR SELFCONSISTENT COMPUTATION
mean Fx : 0.69334
mean Lx : 2.6144
Mode Fy : 0.063793-3.4694e-18i
Mode AE : 2.0081
Mode omega : 0.84352
</pre><pre class="codeinput"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
disp(<span class="string">' '</span> );
disp(<span class="string">'### 4 : ADAPT ON MODE'</span>);
disp(<span class="string">' '</span> );
<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.745i,<span class="string">'type'</span>,<span class="string">'D'</span>);
bf=SF_Adapt(bf,em,<span class="string">'Hmax'</span>,10);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.745i,<span class="string">'type'</span>,<span class="string">'D'</span>);
bf=SF_Adapt(bf,em,<span class="string">'Hmax'</span>,10);

<span class="comment">% plot the mesh (full size)</span>
bf.xlim = [-40 80]; bf.ylim=[0,40];
SF_Plot(bf,<span class="string">'mesh'</span>);
<span class="comment">%title('Mesh M4 (full size)');</span>
box <span class="string">on</span>; pos = get(gcf,<span class="string">'Position'</span>); pos(4)=pos(3)*.4;set(gcf,<span class="string">'Position'</span>,pos); <span class="comment">% resize aspect ratio</span>
set(gca,<span class="string">'FontSize'</span>, 18);
saveas(gca,<span class="string">'FIGURES/Cylinder_Mesh4_Full'</span>,figureformat);

<span class="comment">% plot the mesh (zoom)</span>
SF_Plot(bf,<span class="string">'mesh'</span>,<span class="string">'xlim'</span>,[-1.5 4.5],<span class="string">'ylim'</span>,[0,3]);
<span class="comment">%title('Mesh M4 (zoom)');</span>
box <span class="string">on</span>; pos = get(gcf,<span class="string">'Position'</span>); pos(4)=pos(3)*AspectRatio;set(gcf,<span class="string">'Position'</span>,pos); <span class="comment">% resize aspect ratio</span>
set(gca,<span class="string">'FontSize'</span>, 18);
saveas(gca,<span class="string">'FIGURES/Cylinder_Mesh4'</span>,figureformat);
pause(0.1);

disp(<span class="string">' '</span>);
disp([<span class="string">'number of vertices : '</span> num2str(bf.mesh.np)]);
disp([<span class="string">'number of DOF : '</span> num2str(bf.mesh.Ndof)]);
disp(<span class="string">'### Mesh grid size at point A,B,C,D : '</span>);
disp([<span class="string">'A   : '</span> num2str(bf.mesh.deltaA)]);
disp([<span class="string">'B   : '</span> num2str(bf.mesh.deltaB)]);
disp([<span class="string">'C   : '</span> num2str(bf.mesh.deltaC)]);
disp([<span class="string">'D   : '</span> num2str(bf.mesh.deltaD)]);
disp([<span class="string">'min : '</span> num2str(bf.mesh.deltamin)]);
disp([<span class="string">'max : '</span> num2str(bf.mesh.deltamax)]);
disp(<span class="string">' '</span> );

bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.74i,<span class="string">'type'</span>,<span class="string">'D'</span>,<span class="string">'nev'</span>,1);
disp(<span class="string">'##### EIGENVALUE COMPUTATION'</span>);

disp([<span class="string">' Eigenvalue : '</span> , num2str(ev)]);

[meanflow,mode] = SF_HB1(bf,em,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.04,<span class="string">'Fyguess'</span>,0.015);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.03);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.02);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.0,<span class="string">'specialmode'</span>,<span class="string">'NEW'</span>);

disp(<span class="string">'##### NONLINEAR SELFCONSISTENT COMPUTATION'</span>);
disp([<span class="string">'mean Fx : '</span> num2str(meanflow.Fx)]);
disp([<span class="string">'mean Lx : '</span> num2str(meanflow.Lx)]);
disp([<span class="string">'Mode Fy : '</span> num2str(mode.Fy)]);
disp([<span class="string">'Mode AE : '</span> num2str(mode.AEnergy)]);
disp([<span class="string">'Mode omega : '</span> num2str(imag(mode.lambda))]);
</pre><pre class="codeoutput"> 
### 4 : ADAPT ON MODE
 
      # Stability calculation completed, eigenvalue = 0.046746+0.74499i ; converged in 7 iterations
      # Stability calculation completed, eigenvalue = 0.046766+0.74498i ; converged in 8 iterations
rm: ./WORK//BASEFLOWS/*: No such file or directory
rm: ./WORK//MEANFLOWS/*: No such file or directory
 
number of vertices : 11952
number of DOF : 106510
### Mesh grid size at point A,B,C,D : 
A   : 0.030468
B   : 0.11146
C   : 0.12639
D   : 0.076548
min : 0.014516
max : 13.5617
 
      # Stability calculation completed, eigenvalue = 0.046748+0.74493i ; converged in 9 iterations
##### EIGENVALUE COMPUTATION
 Eigenvalue : 0.046748+0.74493i
##### NONLINEAR SELFCONSISTENT COMPUTATION
mean Fx : 0.69313
mean Lx : 2.6145
Mode Fy : 0.063809-2.6021e-18i
Mode AE : 2.56
Mode omega : 0.84351
</pre><img vspace="5" hspace="5" src="SCRIPT_CYLINDER_MESHTESTS_02.png" alt=""> <pre class="codeinput"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
disp(<span class="string">' '</span> );
disp(<span class="string">'### 5 : ADAPT ON MODE (adjoint)'</span>);
disp(<span class="string">' '</span> );
<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">%bf=SF_Split(bf);</span>
bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.745i,<span class="string">'type'</span>,<span class="string">'A'</span>);
bf=SF_Adapt(bf,em,<span class="string">'Hmax'</span>,10);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.745i,<span class="string">'type'</span>,<span class="string">'A'</span>);
bf=SF_Adapt(bf,em,<span class="string">'Hmax'</span>,10);

disp(<span class="string">' '</span>);
disp([<span class="string">'number of vertices : '</span> num2str(bf.mesh.np)]);
disp([<span class="string">'number of DOF : '</span> num2str(bf.mesh.Ndof)]);
disp(<span class="string">'### Mesh grid size at point A,B,C,D : '</span>);
disp([<span class="string">'A   : '</span> num2str(bf.mesh.deltaA)]);
disp([<span class="string">'B   : '</span> num2str(bf.mesh.deltaB)]);
disp([<span class="string">'C   : '</span> num2str(bf.mesh.deltaC)]);
disp([<span class="string">'D   : '</span> num2str(bf.mesh.deltaD)]);
disp([<span class="string">'min : '</span> num2str(bf.mesh.deltamin)]);
disp([<span class="string">'max : '</span> num2str(bf.mesh.deltamax)]);
disp(<span class="string">' '</span> );

bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.74i,<span class="string">'type'</span>,<span class="string">'D'</span>);
disp(<span class="string">'##### EIGENVALUE COMPUTATION'</span>);

disp([<span class="string">' Eigenvalue : '</span> , num2str(ev)]);

[meanflow,mode] = SF_HB1(bf,em,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.04,<span class="string">'Fyguess'</span>,0.015);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.03);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.02);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.0,<span class="string">'specialmode'</span>,<span class="string">'NEW'</span>);

disp(<span class="string">'##### NONLINEAR SELFCONSISTENT COMPUTATION'</span>);
disp([<span class="string">'mean Fx : '</span> num2str(meanflow.Fx)]);
disp([<span class="string">'mean Lx : '</span> num2str(meanflow.Lx)]);
disp([<span class="string">'Mode Fy : '</span> num2str(mode.Fy)]);
disp([<span class="string">'Mode AE : '</span> num2str(mode.AEnergy)]);
disp([<span class="string">'Mode omega : '</span> num2str(imag(mode.lambda))]);
</pre><pre class="codeoutput"> 
### 5 : ADAPT ON MODE (adjoint)
 
</pre><pre class="codeoutput error">Undefined function or variable 'guess'.

Error in SF_Stability (line 186)
   if(isstruct(guess))

Error in SCRIPT_CYLINDER_MESHTESTS (line 278)
[ev,em] = SF_Stability(bf,'shift',0.04+.745i,'type','A');
</pre><pre class="codeinput"> <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
 disp(<span class="string">' '</span>);
 disp(<span class="string">'### 6 : [-20 40 20]'</span>);
 disp(<span class="string">' '</span>);
 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>


 bf=SF_Init(<span class="string">'Mesh_Cylinder.edp'</span>,[-20 40 20]);
 bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,1);
 bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,10);
 bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
 bf=SF_Adapt(bf,<span class="string">'Hmax'</span>,10);
 bf=SF_Adapt(bf,<span class="string">'Hmax'</span>,10);

bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.745i,<span class="string">'type'</span>,<span class="string">'S'</span>);
bf=SF_Adapt(bf,em,<span class="string">'Hmax'</span>,10);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.745i,<span class="string">'type'</span>,<span class="string">'S'</span>);
bf=SF_Adapt(bf,em,<span class="string">'Hmax'</span>,10);



disp(<span class="string">' '</span>);
disp([<span class="string">'number of vertices : '</span> num2str(bf.mesh.np)]);
disp([<span class="string">'number of DOF : '</span> num2str(bf.mesh.Ndof)]);
disp(<span class="string">'### Mesh grid size at point A,B,C,D : '</span>);
disp([<span class="string">'A   : '</span> num2str(bf.mesh.deltaA)]);
disp([<span class="string">'B   : '</span> num2str(bf.mesh.deltaB)]);
disp([<span class="string">'C   : '</span> num2str(bf.mesh.deltaC)]);
disp([<span class="string">'D   : '</span> num2str(bf.mesh.deltaD)]);
disp([<span class="string">'min : '</span> num2str(bf.mesh.deltamin)]);
disp([<span class="string">'max : '</span> num2str(bf.mesh.deltamax)]);
disp(<span class="string">' '</span> );

bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.74i,<span class="string">'type'</span>,<span class="string">'D'</span>);
disp(<span class="string">'##### EIGENVALUE COMPUTATION'</span>);

disp([<span class="string">' Eigenvalue : '</span> , num2str(ev)]);

[meanflow,mode] = SF_HB1(bf,em,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.04,<span class="string">'Fyguess'</span>,0.015);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.03);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.02);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.0,<span class="string">'specialmode'</span>,<span class="string">'NEW'</span>);

disp(<span class="string">'##### NONLINEAR SELFCONSISTENT COMPUTATION'</span>);
disp([<span class="string">'mean Fx : '</span> num2str(meanflow.Fx)]);
disp([<span class="string">'mean Lx : '</span> num2str(meanflow.Lx)]);
disp([<span class="string">'Mode Fy : '</span> num2str(mode.Fy)]);
disp([<span class="string">'Mode AE : '</span> num2str(mode.AEnergy)]);
disp([<span class="string">'Mode omega : '</span> num2str(imag(mode.lambda))]);
</pre><pre class="codeinput"> <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
 disp(<span class="string">' '</span>);
 disp(<span class="string">'### 7 : [-80 160 80]'</span>);
 disp(<span class="string">' '</span>);
 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>


 bf=SF_Init(<span class="string">'Mesh_Cylinder.edp'</span>,[-80 160 80]);
 bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,1);
 bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,10);
 bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
 bf=SF_Adapt(bf,<span class="string">'Hmax'</span>,10);
 bf=SF_Adapt(bf,<span class="string">'Hmax'</span>,10);

bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.745i,<span class="string">'type'</span>,<span class="string">'S'</span>);
bf=SF_Adapt(bf,em,<span class="string">'Hmax'</span>,10);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.745i,<span class="string">'type'</span>,<span class="string">'S'</span>);
bf=SF_Adapt(bf,em,<span class="string">'Hmax'</span>,10);

disp(<span class="string">' '</span>);
disp([<span class="string">'number of vertices : '</span> num2str(bf.mesh.np)]);
disp([<span class="string">'number of DOF : '</span> num2str(bf.mesh.Ndof)]);
disp(<span class="string">'### Mesh grid size at point A,B,C,D : '</span>);
disp([<span class="string">'A   : '</span> num2str(bf.mesh.deltaA)]);
disp([<span class="string">'B   : '</span> num2str(bf.mesh.deltaB)]);
disp([<span class="string">'C   : '</span> num2str(bf.mesh.deltaC)]);
disp([<span class="string">'D   : '</span> num2str(bf.mesh.deltaD)]);
disp([<span class="string">'min : '</span> num2str(bf.mesh.deltamin)]);
disp([<span class="string">'max : '</span> num2str(bf.mesh.deltamax)]);
disp(<span class="string">' '</span> );

bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.74i,<span class="string">'type'</span>,<span class="string">'D'</span>);
disp(<span class="string">'##### EIGENVALUE COMPUTATION'</span>);

disp([<span class="string">' Eigenvalue : '</span> , num2str(ev)]);

[meanflow,mode] = SF_HB1(bf,em,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.04,<span class="string">'Fyguess'</span>,0.015);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.03);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.02);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.0,<span class="string">'specialmode'</span>,<span class="string">'NEW'</span>);

disp(<span class="string">'##### NONLINEAR SELFCONSISTENT COMPUTATION'</span>);
disp([<span class="string">'mean Fx : '</span> num2str(meanflow.Fx)]);
disp([<span class="string">'mean Lx : '</span> num2str(meanflow.Lx)]);
disp([<span class="string">'Mode Fy : '</span> num2str(mode.Fy)]);
disp([<span class="string">'Mode AE : '</span> num2str(mode.AEnergy)]);
disp([<span class="string">'Mode omega : '</span> num2str(imag(mode.lambda))]);
</pre><pre class="codeinput"> <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
 disp(<span class="string">' '</span>);
 disp(<span class="string">'### 8 : [-40 80 40] WITH SLIP CONDITIONS'</span>);
 disp(<span class="string">' '</span>);
 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>


 bf=SF_Init(<span class="string">'Mesh_Cylinder_SlipConditions.edp'</span>,[-40 80 40]);
 bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,1);
 bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,10);
 bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
 bf=SF_Adapt(bf,<span class="string">'Hmax'</span>,10);
 bf=SF_Adapt(bf,<span class="string">'Hmax'</span>,10);

bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.745i,<span class="string">'type'</span>,<span class="string">'S'</span>);
bf=SF_Adapt(bf,em,<span class="string">'Hmax'</span>,10);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.745i,<span class="string">'type'</span>,<span class="string">'S'</span>);
bf=SF_Adapt(bf,em,<span class="string">'Hmax'</span>,10);

disp(<span class="string">' '</span>);
disp([<span class="string">'number of vertices : '</span> num2str(bf.mesh.np)]);
disp([<span class="string">'number of DOF : '</span> num2str(bf.mesh.Ndof)]);
disp(<span class="string">'### Mesh grid size at point A,B,C,D : '</span>);
disp([<span class="string">'A   : '</span> num2str(bf.mesh.deltaA)]);
disp([<span class="string">'B   : '</span> num2str(bf.mesh.deltaB)]);
disp([<span class="string">'C   : '</span> num2str(bf.mesh.deltaC)]);
disp([<span class="string">'D   : '</span> num2str(bf.mesh.deltaD)]);
disp([<span class="string">'min : '</span> num2str(bf.mesh.deltamin)]);
disp([<span class="string">'max : '</span> num2str(bf.mesh.deltamax)]);
disp(<span class="string">' '</span> );

bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.74i,<span class="string">'type'</span>,<span class="string">'D'</span>);
disp(<span class="string">'##### EIGENVALUE COMPUTATION'</span>);

disp([<span class="string">' Eigenvalue : '</span> , num2str(ev)]);

[meanflow,mode] = SF_HB1(bf,em,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.04,<span class="string">'Fyguess'</span>,0.015);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.03);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.02);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.0,<span class="string">'specialmode'</span>,<span class="string">'NEW'</span>);

disp(<span class="string">'##### NONLINEAR SELFCONSISTENT COMPUTATION'</span>);
disp([<span class="string">'mean Fx : '</span> num2str(meanflow.Fx)]);
disp([<span class="string">'mean Lx : '</span> num2str(meanflow.Lx)]);
disp([<span class="string">'Mode Fy : '</span> num2str(mode.Fy)]);
disp([<span class="string">'Mode AE : '</span> num2str(mode.AEnergy)]);
disp([<span class="string">'Mode omega : '</span> num2str(imag(mode.lambda))]);
</pre><pre class="codeinput"> <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
 disp(<span class="string">' '</span>);
 disp(<span class="string">'### 9 : [-40 80 40] WITH NO SLIP CONDITIONS'</span>);
 disp(<span class="string">' '</span>);
 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>


 bf=SF_Init(<span class="string">'Mesh_Cylinder_NoSlipConditions.edp'</span>,[-40 80 40]);
 bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,1);
 bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,10);
 bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
 bf=SF_Adapt(bf,<span class="string">'Hmax'</span>,10);
 bf=SF_Adapt(bf,<span class="string">'Hmax'</span>,10);

bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.745i,<span class="string">'type'</span>,<span class="string">'S'</span>);
bf=SF_Adapt(bf,em,<span class="string">'Hmax'</span>,10);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.745i,<span class="string">'type'</span>,<span class="string">'S'</span>);
bf=SF_Adapt(bf,em,<span class="string">'Hmax'</span>,10);

disp(<span class="string">' '</span>);
disp([<span class="string">'number of vertices : '</span> num2str(bf.mesh.np)]);
disp([<span class="string">'number of DOF : '</span> num2str(bf.mesh.Ndof)]);
disp(<span class="string">'### Mesh grid size at point A,B,C,D : '</span>);
disp([<span class="string">'A   : '</span> num2str(bf.mesh.deltaA)]);
disp([<span class="string">'B   : '</span> num2str(bf.mesh.deltaB)]);
disp([<span class="string">'C   : '</span> num2str(bf.mesh.deltaC)]);
disp([<span class="string">'D   : '</span> num2str(bf.mesh.deltaD)]);
disp([<span class="string">'min : '</span> num2str(bf.mesh.deltamin)]);
disp([<span class="string">'max : '</span> num2str(bf.mesh.deltamax)]);
disp(<span class="string">' '</span> );

bf=SF_BaseFlow(bf,<span class="string">'Re'</span>,60);
[ev,em] = SF_Stability(bf,<span class="string">'shift'</span>,0.04+.74i,<span class="string">'type'</span>,<span class="string">'D'</span>);
disp(<span class="string">'##### EIGENVALUE COMPUTATION'</span>);

disp([<span class="string">' Eigenvalue : '</span> , num2str(ev)]);

[meanflow,mode] = SF_HB1(bf,em,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.04,<span class="string">'Fyguess'</span>,0.015);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.03);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.02);
[meanflow,mode] = SF_HB1(meanflow,mode,<span class="string">'Re'</span>,60,<span class="string">'sigma'</span>,0.0,<span class="string">'specialmode'</span>,<span class="string">'NEW'</span>);

disp(<span class="string">'##### NONLINEAR SELFCONSISTENT COMPUTATION'</span>);
disp([<span class="string">'mean Fx : '</span> num2str(meanflow.Fx)]);
disp([<span class="string">'mean Lx : '</span> num2str(meanflow.Lx)]);
disp([<span class="string">'Mode Fy : '</span> num2str(mode.Fy)]);
disp([<span class="string">'Mode AE : '</span> num2str(mode.AEnergy)]);
disp([<span class="string">'Mode omega : '</span> num2str(imag(mode.lambda))]);
</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2017b</a><br></p></div><!--
##### SOURCE BEGIN #####
%  Instability of the wake of a cylinder with STABFEM  
%
%  THIS SCRIPT COMPARES THE RESULTS OBTAINED WITH 7 DIFFERENT MESHES

% CHAPTER 0 : set the global variables needed by the drivers

run('../../SOURCES_MATLAB/SF_Start.m');
verbosity=0;
figureformat='png'; AspectRatio = 0.56; % for figure

 
%%
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 disp(' ');    
 disp('### 1 : MESH based on base flow : ');     
 disp(' ');
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
 
 bf=SF_Init('Mesh_Cylinder.edp',[-40 80 40]);
 bf=SF_BaseFlow(bf,'Re',1);
 bf=SF_BaseFlow(bf,'Re',10);
 bf=SF_BaseFlow(bf,'Re',60);
 bf=SF_Adapt(bf,'Hmax',10);
 bf=SF_Adapt(bf,'Hmax',10);
 
disp(' ');
disp(['number of vertices : ' num2str(bf.mesh.np)]);
disp(['number of DOF : ' num2str(bf.mesh.Ndof)]);
disp('### Mesh grid size at point A,B,C,D : ');
disp(['A   : ' num2str(bf.mesh.deltaA)]);
disp(['B   : ' num2str(bf.mesh.deltaB)]);
disp(['C   : ' num2str(bf.mesh.deltaC)]);
disp(['D   : ' num2str(bf.mesh.deltaD)]);
disp(['min : ' num2str(bf.mesh.deltamin)]);
disp(['max : ' num2str(bf.mesh.deltamax)]);
disp(' ' );

bf=SF_BaseFlow(bf,'Re',60);
[ev,em] = SF_Stability(bf,'shift',0.04+.74i,'type','D');
disp('##### EIGENVALUE COMPUTATION');

disp([' Eigenvalue : ' , num2str(ev)]);

[meanflow,mode] = SF_HB1(bf,em,'Re',60,'sigma',0.04,'Fyguess',0.015);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.03);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.02);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.0,'specialmode','NEW');

disp('##### NONLINEAR SELFCONSISTENT COMPUTATION');
disp(['mean Fx : ' num2str(meanflow.Fx)]);
disp(['mean Lx : ' num2str(meanflow.Lx)]);
disp(['Mode Fy : ' num2str(mode.Fy)]);
disp(['Mode AE : ' num2str(mode.AEnergy)]);
disp(['Mode omega : ' num2str(imag(mode.lambda))]);


%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
disp(' ' );
disp('### 2 : ADAPT ON SENSITIVITY (ref case)');
disp(' ' );
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

bf=SF_BaseFlow(bf,'Re',60);
[ev,em] = SF_Stability(bf,'shift',0.04+.745i,'type','S');
bf=SF_Adapt(bf,em,'Hmax',10);
[ev,em] = SF_Stability(bf,'shift',0.04+.745i,'type','S');
bf=SF_Adapt(bf,em,'Hmax',10);


% plot the mesh (full size)
bf.xlim = [-40 80]; bf.ylim=[0,40];
SF_Plot(bf,'mesh');
%title('Mesh M2 (full size)');
box on; pos = get(gcf,'Position'); pos(4)=pos(3)*.4;set(gcf,'Position',pos); % resize aspect ratio
set(gca,'FontSize', 18);
saveas(gca,'FIGURES/Cylinder_Mesh2_Full',figureformat); 

% plot the mesh (zoom)
SF_Plot(bf,'mesh','xlim',[-1.5 4.5],'ylim',[0,3]);
%title('Mesh M2 (zoom)');
box on; pos = get(gcf,'Position'); pos(4)=pos(3)*AspectRatio;set(gcf,'Position',pos); % resize aspect ratio
set(gca,'FontSize', 18);
saveas(gca,'FIGURES/Cylinder_Mesh2',figureformat);
pause(0.1);

disp(' ');
disp(['number of vertices : ' num2str(bf.mesh.np)]);
disp(['number of DOF : ' num2str(bf.mesh.Ndof)]);
disp('### Mesh grid size at point A,B,C,D : ');
disp(['A   : ' num2str(bf.mesh.deltaA)]);
disp(['B   : ' num2str(bf.mesh.deltaB)]);
disp(['C   : ' num2str(bf.mesh.deltaC)]);
disp(['D   : ' num2str(bf.mesh.deltaD)]);
disp(['min : ' num2str(bf.mesh.deltamin)]);
disp(['max : ' num2str(bf.mesh.deltamax)]);
disp(' ' );

bf=SF_BaseFlow(bf,'Re',60);
[ev,em] = SF_Stability(bf,'shift',0.04+.74i,'type','D');
disp('##### EIGENVALUE COMPUTATION');

disp([' Eigenvalue : ' , num2str(ev)]);

[meanflow,mode] = SF_HB1(bf,em,'Re',60,'sigma',0.04,'Fyguess',0.015);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.03);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.02);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.0,'specialmode','NEW');

disp('##### NONLINEAR SELFCONSISTENT COMPUTATION');
disp(['mean Fx : ' num2str(meanflow.Fx)]);
disp(['mean Lx : ' num2str(meanflow.Lx)]);
disp(['Mode Fy : ' num2str(mode.Fy)]);
disp(['Mode AE : ' num2str(mode.AEnergy)]);
disp(['Mode omega : ' num2str(imag(mode.lambda))]);



%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
disp(' ' );
disp('### 2bis : ADAPT ON SENSITIVITY (split)');
disp(' ' );
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

bf=SF_Split(bf);

disp(' ');
disp(['number of vertices : ' num2str(bf.mesh.np)]);
disp(['number of DOF : ' num2str(bf.mesh.Ndof)]);
disp('### Mesh grid size at point A,B,C,D : ');
disp(['A   : ' num2str(bf.mesh.deltaA)]);
disp(['B   : ' num2str(bf.mesh.deltaB)]);
disp(['C   : ' num2str(bf.mesh.deltaC)]);
disp(['D   : ' num2str(bf.mesh.deltaD)]);
disp(['min : ' num2str(bf.mesh.deltamin)]);
disp(['max : ' num2str(bf.mesh.deltamax)]);
disp(' ' );

bf=SF_BaseFlow(bf,'Re',60);
[ev,em] = SF_Stability(bf,'shift',0.04+.74i,'type','D');

disp('##### EIGENVALUE COMPUTATION');

disp([' Eigenvalue : ' , num2str(ev)]);

[meanflow,mode] = SF_HB1(bf,em,'Re',60,'sigma',0.04,'Fyguess',0.015);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.03);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.02);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.0,'specialmode','NEW');

disp('##### NONLINEAR SELFCONSISTENT COMPUTATION');
disp(['mean Fx : ' num2str(meanflow.Fx)]);
disp(['mean Lx : ' num2str(meanflow.Lx)]);
disp(['Mode Fy : ' num2str(mode.Fy)]);
disp(['Mode AE : ' num2str(mode.AEnergy)]);
disp(['Mode omega : ' num2str(imag(mode.lambda))]);

%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
disp(' ' );
disp('### 3 : ADAPT ON ENDOGENEITY');
disp(' ' );
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

bf=SF_BaseFlow(bf,'Re',60);
[ev,em] = SF_Stability(bf,'shift',0.04+.745i,'type','E');
bf=SF_Adapt(bf,em,'Hmax',10);
[ev,em] = SF_Stability(bf,'shift',0.04+.745i,'type','E');
bf=SF_Adapt(bf,em,'Hmax',10);

disp(' ');
disp(['number of vertices : ' num2str(bf.mesh.np)]);
disp('### Mesh grid size at point A,B,C,D : ');
disp(['A   : ' num2str(bf.mesh.deltaA)]);
disp(['B   : ' num2str(bf.mesh.deltaB)]);
disp(['C   : ' num2str(bf.mesh.deltaC)]);
disp(['D   : ' num2str(bf.mesh.deltaD)]);
disp(['min : ' num2str(bf.mesh.deltamin)]);
disp(['max : ' num2str(bf.mesh.deltamax)]);
disp(' ' );

bf=SF_BaseFlow(bf,'Re',60);
[ev,em] = SF_Stability(bf,'shift',0.04+.74i,'type','D');
disp('##### EIGENVALUE COMPUTATION');

disp([' Eigenvalue : ' , num2str(ev)]);
[meanflow,mode] = SF_HB1(bf,em,'sigma',0.04,'Re',60,'FYguess',0.015);
%[meanflow,mode] = SF_HB1(bf,em,'Re',60,'sigma',0.04,'Fyguess',0.015);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.03);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.02);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.0,'specialmode','NEW');

disp('##### NONLINEAR SELFCONSISTENT COMPUTATION');
disp(['mean Fx : ' num2str(meanflow.Fx)]);
disp(['mean Lx : ' num2str(meanflow.Lx)]);
disp(['Mode Fy : ' num2str(mode.Fy)]);
disp(['Mode AE : ' num2str(mode.AEnergy)]);
disp(['Mode omega : ' num2str(imag(mode.lambda))]);





%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
disp(' ' );
disp('### 4 : ADAPT ON MODE');
disp(' ' );
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

bf=SF_BaseFlow(bf,'Re',60);
[ev,em] = SF_Stability(bf,'shift',0.04+.745i,'type','D');
bf=SF_Adapt(bf,em,'Hmax',10);
[ev,em] = SF_Stability(bf,'shift',0.04+.745i,'type','D');
bf=SF_Adapt(bf,em,'Hmax',10);

% plot the mesh (full size)
bf.xlim = [-40 80]; bf.ylim=[0,40];
SF_Plot(bf,'mesh');
%title('Mesh M4 (full size)');
box on; pos = get(gcf,'Position'); pos(4)=pos(3)*.4;set(gcf,'Position',pos); % resize aspect ratio
set(gca,'FontSize', 18);
saveas(gca,'FIGURES/Cylinder_Mesh4_Full',figureformat); 

% plot the mesh (zoom)
SF_Plot(bf,'mesh','xlim',[-1.5 4.5],'ylim',[0,3]);
%title('Mesh M4 (zoom)');
box on; pos = get(gcf,'Position'); pos(4)=pos(3)*AspectRatio;set(gcf,'Position',pos); % resize aspect ratio
set(gca,'FontSize', 18);
saveas(gca,'FIGURES/Cylinder_Mesh4',figureformat);
pause(0.1);

disp(' ');
disp(['number of vertices : ' num2str(bf.mesh.np)]);
disp(['number of DOF : ' num2str(bf.mesh.Ndof)]);
disp('### Mesh grid size at point A,B,C,D : ');
disp(['A   : ' num2str(bf.mesh.deltaA)]);
disp(['B   : ' num2str(bf.mesh.deltaB)]);
disp(['C   : ' num2str(bf.mesh.deltaC)]);
disp(['D   : ' num2str(bf.mesh.deltaD)]);
disp(['min : ' num2str(bf.mesh.deltamin)]);
disp(['max : ' num2str(bf.mesh.deltamax)]);
disp(' ' );

bf=SF_BaseFlow(bf,'Re',60);
[ev,em] = SF_Stability(bf,'shift',0.04+.74i,'type','D','nev',1);
disp('##### EIGENVALUE COMPUTATION');

disp([' Eigenvalue : ' , num2str(ev)]);

[meanflow,mode] = SF_HB1(bf,em,'Re',60,'sigma',0.04,'Fyguess',0.015);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.03);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.02);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.0,'specialmode','NEW');

disp('##### NONLINEAR SELFCONSISTENT COMPUTATION');
disp(['mean Fx : ' num2str(meanflow.Fx)]);
disp(['mean Lx : ' num2str(meanflow.Lx)]);
disp(['Mode Fy : ' num2str(mode.Fy)]);
disp(['Mode AE : ' num2str(mode.AEnergy)]);
disp(['Mode omega : ' num2str(imag(mode.lambda))]);





%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
disp(' ' );
disp('### 5 : ADAPT ON MODE (adjoint)');
disp(' ' );
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%bf=SF_Split(bf);
bf=SF_BaseFlow(bf,'Re',60);
[ev,em] = SF_Stability(bf,'shift',0.04+.745i,'type','A');
bf=SF_Adapt(bf,em,'Hmax',10);
[ev,em] = SF_Stability(bf,'shift',0.04+.745i,'type','A');
bf=SF_Adapt(bf,em,'Hmax',10);

disp(' ');
disp(['number of vertices : ' num2str(bf.mesh.np)]);
disp(['number of DOF : ' num2str(bf.mesh.Ndof)]);
disp('### Mesh grid size at point A,B,C,D : ');
disp(['A   : ' num2str(bf.mesh.deltaA)]);
disp(['B   : ' num2str(bf.mesh.deltaB)]);
disp(['C   : ' num2str(bf.mesh.deltaC)]);
disp(['D   : ' num2str(bf.mesh.deltaD)]);
disp(['min : ' num2str(bf.mesh.deltamin)]);
disp(['max : ' num2str(bf.mesh.deltamax)]);
disp(' ' );

bf=SF_BaseFlow(bf,'Re',60);
[ev,em] = SF_Stability(bf,'shift',0.04+.74i,'type','D');
disp('##### EIGENVALUE COMPUTATION');

disp([' Eigenvalue : ' , num2str(ev)]);

[meanflow,mode] = SF_HB1(bf,em,'Re',60,'sigma',0.04,'Fyguess',0.015);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.03);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.02);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.0,'specialmode','NEW');

disp('##### NONLINEAR SELFCONSISTENT COMPUTATION');
disp(['mean Fx : ' num2str(meanflow.Fx)]);
disp(['mean Lx : ' num2str(meanflow.Lx)]);
disp(['Mode Fy : ' num2str(mode.Fy)]);
disp(['Mode AE : ' num2str(mode.AEnergy)]);
disp(['Mode omega : ' num2str(imag(mode.lambda))]);







%%
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 disp(' ');    
 disp('### 6 : [-20 40 20]');     
 disp(' ');
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
 
 bf=SF_Init('Mesh_Cylinder.edp',[-20 40 20]);
 bf=SF_BaseFlow(bf,'Re',1);
 bf=SF_BaseFlow(bf,'Re',10);
 bf=SF_BaseFlow(bf,'Re',60);
 bf=SF_Adapt(bf,'Hmax',10);
 bf=SF_Adapt(bf,'Hmax',10);

bf=SF_BaseFlow(bf,'Re',60);
[ev,em] = SF_Stability(bf,'shift',0.04+.745i,'type','S');
bf=SF_Adapt(bf,em,'Hmax',10);
[ev,em] = SF_Stability(bf,'shift',0.04+.745i,'type','S');
bf=SF_Adapt(bf,em,'Hmax',10);



disp(' ');
disp(['number of vertices : ' num2str(bf.mesh.np)]);
disp(['number of DOF : ' num2str(bf.mesh.Ndof)]);
disp('### Mesh grid size at point A,B,C,D : ');
disp(['A   : ' num2str(bf.mesh.deltaA)]);
disp(['B   : ' num2str(bf.mesh.deltaB)]);
disp(['C   : ' num2str(bf.mesh.deltaC)]);
disp(['D   : ' num2str(bf.mesh.deltaD)]);
disp(['min : ' num2str(bf.mesh.deltamin)]);
disp(['max : ' num2str(bf.mesh.deltamax)]);
disp(' ' );

bf=SF_BaseFlow(bf,'Re',60);
[ev,em] = SF_Stability(bf,'shift',0.04+.74i,'type','D');
disp('##### EIGENVALUE COMPUTATION');

disp([' Eigenvalue : ' , num2str(ev)]);

[meanflow,mode] = SF_HB1(bf,em,'Re',60,'sigma',0.04,'Fyguess',0.015);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.03);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.02);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.0,'specialmode','NEW');

disp('##### NONLINEAR SELFCONSISTENT COMPUTATION');
disp(['mean Fx : ' num2str(meanflow.Fx)]);
disp(['mean Lx : ' num2str(meanflow.Lx)]);
disp(['Mode Fy : ' num2str(mode.Fy)]);
disp(['Mode AE : ' num2str(mode.AEnergy)]);
disp(['Mode omega : ' num2str(imag(mode.lambda))]);


%%
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 disp(' ');    
 disp('### 7 : [-80 160 80]');     
 disp(' ');
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
 
 bf=SF_Init('Mesh_Cylinder.edp',[-80 160 80]);
 bf=SF_BaseFlow(bf,'Re',1);
 bf=SF_BaseFlow(bf,'Re',10);
 bf=SF_BaseFlow(bf,'Re',60);
 bf=SF_Adapt(bf,'Hmax',10);
 bf=SF_Adapt(bf,'Hmax',10);

bf=SF_BaseFlow(bf,'Re',60);
[ev,em] = SF_Stability(bf,'shift',0.04+.745i,'type','S');
bf=SF_Adapt(bf,em,'Hmax',10);
[ev,em] = SF_Stability(bf,'shift',0.04+.745i,'type','S');
bf=SF_Adapt(bf,em,'Hmax',10);

disp(' ');
disp(['number of vertices : ' num2str(bf.mesh.np)]);
disp(['number of DOF : ' num2str(bf.mesh.Ndof)]);
disp('### Mesh grid size at point A,B,C,D : ');
disp(['A   : ' num2str(bf.mesh.deltaA)]);
disp(['B   : ' num2str(bf.mesh.deltaB)]);
disp(['C   : ' num2str(bf.mesh.deltaC)]);
disp(['D   : ' num2str(bf.mesh.deltaD)]);
disp(['min : ' num2str(bf.mesh.deltamin)]);
disp(['max : ' num2str(bf.mesh.deltamax)]);
disp(' ' );

bf=SF_BaseFlow(bf,'Re',60);
[ev,em] = SF_Stability(bf,'shift',0.04+.74i,'type','D');
disp('##### EIGENVALUE COMPUTATION');

disp([' Eigenvalue : ' , num2str(ev)]);

[meanflow,mode] = SF_HB1(bf,em,'Re',60,'sigma',0.04,'Fyguess',0.015);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.03);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.02);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.0,'specialmode','NEW');

disp('##### NONLINEAR SELFCONSISTENT COMPUTATION');
disp(['mean Fx : ' num2str(meanflow.Fx)]);
disp(['mean Lx : ' num2str(meanflow.Lx)]);
disp(['Mode Fy : ' num2str(mode.Fy)]);
disp(['Mode AE : ' num2str(mode.AEnergy)]);
disp(['Mode omega : ' num2str(imag(mode.lambda))]);





%%
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 disp(' ');    
 disp('### 8 : [-40 80 40] WITH SLIP CONDITIONS');     
 disp(' ');
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
 
 bf=SF_Init('Mesh_Cylinder_SlipConditions.edp',[-40 80 40]);
 bf=SF_BaseFlow(bf,'Re',1);
 bf=SF_BaseFlow(bf,'Re',10);
 bf=SF_BaseFlow(bf,'Re',60);
 bf=SF_Adapt(bf,'Hmax',10);
 bf=SF_Adapt(bf,'Hmax',10);

bf=SF_BaseFlow(bf,'Re',60);
[ev,em] = SF_Stability(bf,'shift',0.04+.745i,'type','S');
bf=SF_Adapt(bf,em,'Hmax',10);
[ev,em] = SF_Stability(bf,'shift',0.04+.745i,'type','S');
bf=SF_Adapt(bf,em,'Hmax',10);

disp(' ');
disp(['number of vertices : ' num2str(bf.mesh.np)]);
disp(['number of DOF : ' num2str(bf.mesh.Ndof)]);
disp('### Mesh grid size at point A,B,C,D : ');
disp(['A   : ' num2str(bf.mesh.deltaA)]);
disp(['B   : ' num2str(bf.mesh.deltaB)]);
disp(['C   : ' num2str(bf.mesh.deltaC)]);
disp(['D   : ' num2str(bf.mesh.deltaD)]);
disp(['min : ' num2str(bf.mesh.deltamin)]);
disp(['max : ' num2str(bf.mesh.deltamax)]);
disp(' ' );

bf=SF_BaseFlow(bf,'Re',60);
[ev,em] = SF_Stability(bf,'shift',0.04+.74i,'type','D');
disp('##### EIGENVALUE COMPUTATION');

disp([' Eigenvalue : ' , num2str(ev)]);

[meanflow,mode] = SF_HB1(bf,em,'Re',60,'sigma',0.04,'Fyguess',0.015);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.03);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.02);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.0,'specialmode','NEW');

disp('##### NONLINEAR SELFCONSISTENT COMPUTATION');
disp(['mean Fx : ' num2str(meanflow.Fx)]);
disp(['mean Lx : ' num2str(meanflow.Lx)]);
disp(['Mode Fy : ' num2str(mode.Fy)]);
disp(['Mode AE : ' num2str(mode.AEnergy)]);
disp(['Mode omega : ' num2str(imag(mode.lambda))]);

%%
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 disp(' ');    
 disp('### 9 : [-40 80 40] WITH NO SLIP CONDITIONS');     
 disp(' ');
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
 
 bf=SF_Init('Mesh_Cylinder_NoSlipConditions.edp',[-40 80 40]);
 bf=SF_BaseFlow(bf,'Re',1);
 bf=SF_BaseFlow(bf,'Re',10);
 bf=SF_BaseFlow(bf,'Re',60);
 bf=SF_Adapt(bf,'Hmax',10);
 bf=SF_Adapt(bf,'Hmax',10);

bf=SF_BaseFlow(bf,'Re',60);
[ev,em] = SF_Stability(bf,'shift',0.04+.745i,'type','S');
bf=SF_Adapt(bf,em,'Hmax',10);
[ev,em] = SF_Stability(bf,'shift',0.04+.745i,'type','S');
bf=SF_Adapt(bf,em,'Hmax',10);

disp(' ');
disp(['number of vertices : ' num2str(bf.mesh.np)]);
disp(['number of DOF : ' num2str(bf.mesh.Ndof)]);
disp('### Mesh grid size at point A,B,C,D : ');
disp(['A   : ' num2str(bf.mesh.deltaA)]);
disp(['B   : ' num2str(bf.mesh.deltaB)]);
disp(['C   : ' num2str(bf.mesh.deltaC)]);
disp(['D   : ' num2str(bf.mesh.deltaD)]);
disp(['min : ' num2str(bf.mesh.deltamin)]);
disp(['max : ' num2str(bf.mesh.deltamax)]);
disp(' ' );

bf=SF_BaseFlow(bf,'Re',60);
[ev,em] = SF_Stability(bf,'shift',0.04+.74i,'type','D');
disp('##### EIGENVALUE COMPUTATION');

disp([' Eigenvalue : ' , num2str(ev)]);

[meanflow,mode] = SF_HB1(bf,em,'Re',60,'sigma',0.04,'Fyguess',0.015);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.03);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.02);
[meanflow,mode] = SF_HB1(meanflow,mode,'Re',60,'sigma',0.0,'specialmode','NEW');

disp('##### NONLINEAR SELFCONSISTENT COMPUTATION');
disp(['mean Fx : ' num2str(meanflow.Fx)]);
disp(['mean Lx : ' num2str(meanflow.Lx)]);
disp(['Mode Fy : ' num2str(mode.Fy)]);
disp(['Mode AE : ' num2str(mode.AEnergy)]);
disp(['Mode omega : ' num2str(imag(mode.lambda))]);


##### SOURCE END #####
--></body></html>